[
  {
    "objectID": "posts/fastai/02-deployment.html",
    "href": "posts/fastai/02-deployment.html",
    "title": "Cat vs. Dog Classifier",
    "section": "",
    "text": "1 Setup and Training\nThe first step is to install necessary dependencies and setup my environment. In my case the fastai toolbox as well as a search engine API. In chapter 2, bing search was the one used. Alas, that got deprecated in the meantime, so I am going to use duckduckgo search another free search API.\n# Clean up previous folders\n!rm -rf animal\n\n# Install latest fastai + fastcore + fastbook\n!pip install -U fastai fastcore fastbook ddgs\n\nimport fastbook\nfastbook.setup_book()\nRequirement already satisfied: fastai in /usr/local/lib/python3.11/dist-packages (2.7.19)\nCollecting fastai\n  Downloading fastai-2.8.2-py3-none-any.whl.metadata (9.5 kB)\nRequirement already satisfied: fastcore in /usr/local/lib/python3.11/dist-packages (1.7.29)\nCollecting fastcore\n  Downloading fastcore-1.8.5-py3-none-any.whl.metadata (3.7 kB)\nCollecting fastbook\n  Downloading fastbook-0.0.29-py3-none-any.whl.metadata (13 kB)\nCollecting ddgs\n  Downloading ddgs-9.3.1-py3-none-any.whl.metadata (15 kB)\nRequirement already satisfied: pip in /usr/local/lib/python3.11/dist-packages (from fastai) (24.1.2)\nRequirement already satisfied: packaging in /usr/local/lib/python3.11/dist-packages (from fastai) (25.0)\nRequirement already satisfied: fastdownload&lt;2,&gt;=0.0.5 in /usr/local/lib/python3.11/dist-packages (from fastai) (0.0.7)\nCollecting fasttransform&gt;=0.0.2 (from fastai)\n  Downloading fasttransform-0.0.2-py3-none-any.whl.metadata (7.6 kB)\nRequirement already satisfied: torchvision&gt;=0.11 in /usr/local/lib/python3.11/dist-packages (from fastai) (0.21.0+cu124)\nRequirement already satisfied: matplotlib in /usr/local/lib/python3.11/dist-packages (from fastai) (3.10.0)\nRequirement already satisfied: pandas in /usr/local/lib/python3.11/dist-packages (from fastai) (2.2.2)\nRequirement already satisfied: requests in /usr/local/lib/python3.11/dist-packages (from fastai) (2.32.3)\nRequirement already satisfied: pyyaml in /usr/local/lib/python3.11/dist-packages (from fastai) (6.0.2)\nRequirement already satisfied: fastprogress&gt;=0.2.4 in /usr/local/lib/python3.11/dist-packages (from fastai) (1.0.3)\nRequirement already satisfied: pillow&gt;=9.0.0 in /usr/local/lib/python3.11/dist-packages (from fastai) (11.2.1)\nRequirement already satisfied: scikit-learn in /usr/local/lib/python3.11/dist-packages (from fastai) (1.6.1)\nRequirement already satisfied: scipy in /usr/local/lib/python3.11/dist-packages (from fastai) (1.15.3)\nRequirement already satisfied: spacy&lt;4 in /usr/local/lib/python3.11/dist-packages (from fastai) (3.8.7)\nCollecting plum-dispatch (from fastai)\n  Downloading plum_dispatch-2.5.7-py3-none-any.whl.metadata (7.5 kB)\nRequirement already satisfied: cloudpickle in /usr/local/lib/python3.11/dist-packages (from fastai) (3.1.1)\nRequirement already satisfied: torch&lt;2.8,&gt;=1.10 in /usr/local/lib/python3.11/dist-packages (from fastai) (2.6.0+cu124)\nRequirement already satisfied: graphviz in /usr/local/lib/python3.11/dist-packages (from fastbook) (0.21)\nRequirement already satisfied: transformers in /usr/local/lib/python3.11/dist-packages (from fastbook) (4.53.2)\nRequirement already satisfied: datasets in /usr/local/lib/python3.11/dist-packages (from fastbook) (2.14.4)\nRequirement already satisfied: ipywidgets&lt;8 in /usr/local/lib/python3.11/dist-packages (from fastbook) (7.7.1)\nRequirement already satisfied: sentencepiece in /usr/local/lib/python3.11/dist-packages (from fastbook) (0.2.0)\nRequirement already satisfied: click&gt;=8.1.8 in /usr/local/lib/python3.11/dist-packages (from ddgs) (8.2.1)\nCollecting primp&gt;=0.15.0 (from ddgs)\n  Downloading primp-0.15.0-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (13 kB)\nRequirement already satisfied: lxml&gt;=5.3.0 in /usr/local/lib/python3.11/dist-packages (from ddgs) (5.4.0)\nRequirement already satisfied: ipykernel&gt;=4.5.1 in /usr/local/lib/python3.11/dist-packages (from ipywidgets&lt;8-&gt;fastbook) (6.17.1)\nRequirement already satisfied: ipython-genutils~=0.2.0 in /usr/local/lib/python3.11/dist-packages (from ipywidgets&lt;8-&gt;fastbook) (0.2.0)\nRequirement already satisfied: traitlets&gt;=4.3.1 in /usr/local/lib/python3.11/dist-packages (from ipywidgets&lt;8-&gt;fastbook) (5.7.1)\nRequirement already satisfied: widgetsnbextension~=3.6.0 in /usr/local/lib/python3.11/dist-packages (from ipywidgets&lt;8-&gt;fastbook) (3.6.10)\nRequirement already satisfied: ipython&gt;=4.0.0 in /usr/local/lib/python3.11/dist-packages (from ipywidgets&lt;8-&gt;fastbook) (7.34.0)\nRequirement already satisfied: jupyterlab-widgets&gt;=1.0.0 in /usr/local/lib/python3.11/dist-packages (from ipywidgets&lt;8-&gt;fastbook) (3.0.15)\nRequirement already satisfied: spacy-legacy&lt;3.1.0,&gt;=3.0.11 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (3.0.12)\nRequirement already satisfied: spacy-loggers&lt;2.0.0,&gt;=1.0.0 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (1.0.5)\nRequirement already satisfied: murmurhash&lt;1.1.0,&gt;=0.28.0 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (1.0.13)\nRequirement already satisfied: cymem&lt;2.1.0,&gt;=2.0.2 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (2.0.11)\nRequirement already satisfied: preshed&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (3.0.10)\nRequirement already satisfied: thinc&lt;8.4.0,&gt;=8.3.4 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (8.3.6)\nRequirement already satisfied: wasabi&lt;1.2.0,&gt;=0.9.1 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (1.1.3)\nRequirement already satisfied: srsly&lt;3.0.0,&gt;=2.4.3 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (2.5.1)\nRequirement already satisfied: catalogue&lt;2.1.0,&gt;=2.0.6 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (2.0.10)\nRequirement already satisfied: weasel&lt;0.5.0,&gt;=0.1.0 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (0.4.1)\nRequirement already satisfied: typer&lt;1.0.0,&gt;=0.3.0 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (0.16.0)\nRequirement already satisfied: tqdm&lt;5.0.0,&gt;=4.38.0 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (4.67.1)\nRequirement already satisfied: numpy&gt;=1.19.0 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (2.0.2)\nRequirement already satisfied: pydantic!=1.8,!=1.8.1,&lt;3.0.0,&gt;=1.7.4 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (2.11.7)\nRequirement already satisfied: jinja2 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (3.1.6)\nRequirement already satisfied: setuptools in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (75.2.0)\nRequirement already satisfied: langcodes&lt;4.0.0,&gt;=3.2.0 in /usr/local/lib/python3.11/dist-packages (from spacy&lt;4-&gt;fastai) (3.5.0)\nRequirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.11/dist-packages (from requests-&gt;fastai) (3.4.2)\nRequirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.11/dist-packages (from requests-&gt;fastai) (3.10)\nRequirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests-&gt;fastai) (2.4.0)\nRequirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests-&gt;fastai) (2025.7.14)\nRequirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from torch&lt;2.8,&gt;=1.10-&gt;fastai) (3.18.0)\nRequirement already satisfied: typing-extensions&gt;=4.10.0 in /usr/local/lib/python3.11/dist-packages (from torch&lt;2.8,&gt;=1.10-&gt;fastai) (4.14.1)\nRequirement already satisfied: networkx in /usr/local/lib/python3.11/dist-packages (from torch&lt;2.8,&gt;=1.10-&gt;fastai) (3.5)\nRequirement already satisfied: fsspec in /usr/local/lib/python3.11/dist-packages (from torch&lt;2.8,&gt;=1.10-&gt;fastai) (2025.3.2)\nCollecting nvidia-cuda-nvrtc-cu12==12.4.127 (from torch&lt;2.8,&gt;=1.10-&gt;fastai)\n  Downloading nvidia_cuda_nvrtc_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\nCollecting nvidia-cuda-runtime-cu12==12.4.127 (from torch&lt;2.8,&gt;=1.10-&gt;fastai)\n  Downloading nvidia_cuda_runtime_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\nCollecting nvidia-cuda-cupti-cu12==12.4.127 (from torch&lt;2.8,&gt;=1.10-&gt;fastai)\n  Downloading nvidia_cuda_cupti_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\nCollecting nvidia-cudnn-cu12==9.1.0.70 (from torch&lt;2.8,&gt;=1.10-&gt;fastai)\n  Downloading nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\nCollecting nvidia-cublas-cu12==12.4.5.8 (from torch&lt;2.8,&gt;=1.10-&gt;fastai)\n  Downloading nvidia_cublas_cu12-12.4.5.8-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\nCollecting nvidia-cufft-cu12==11.2.1.3 (from torch&lt;2.8,&gt;=1.10-&gt;fastai)\n  Downloading nvidia_cufft_cu12-11.2.1.3-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\nCollecting nvidia-curand-cu12==10.3.5.147 (from torch&lt;2.8,&gt;=1.10-&gt;fastai)\n  Downloading nvidia_curand_cu12-10.3.5.147-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\nCollecting nvidia-cusolver-cu12==11.6.1.9 (from torch&lt;2.8,&gt;=1.10-&gt;fastai)\n  Downloading nvidia_cusolver_cu12-11.6.1.9-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\nCollecting nvidia-cusparse-cu12==12.3.1.170 (from torch&lt;2.8,&gt;=1.10-&gt;fastai)\n  Downloading nvidia_cusparse_cu12-12.3.1.170-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\nRequirement already satisfied: nvidia-cusparselt-cu12==0.6.2 in /usr/local/lib/python3.11/dist-packages (from torch&lt;2.8,&gt;=1.10-&gt;fastai) (0.6.2)\nRequirement already satisfied: nvidia-nccl-cu12==2.21.5 in /usr/local/lib/python3.11/dist-packages (from torch&lt;2.8,&gt;=1.10-&gt;fastai) (2.21.5)\nRequirement already satisfied: nvidia-nvtx-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch&lt;2.8,&gt;=1.10-&gt;fastai) (12.4.127)\nCollecting nvidia-nvjitlink-cu12==12.4.127 (from torch&lt;2.8,&gt;=1.10-&gt;fastai)\n  Downloading nvidia_nvjitlink_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\nRequirement already satisfied: triton==3.2.0 in /usr/local/lib/python3.11/dist-packages (from torch&lt;2.8,&gt;=1.10-&gt;fastai) (3.2.0)\nRequirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.11/dist-packages (from torch&lt;2.8,&gt;=1.10-&gt;fastai) (1.13.1)\nRequirement already satisfied: mpmath&lt;1.4,&gt;=1.1.0 in /usr/local/lib/python3.11/dist-packages (from sympy==1.13.1-&gt;torch&lt;2.8,&gt;=1.10-&gt;fastai) (1.3.0)\nRequirement already satisfied: pyarrow&gt;=8.0.0 in /usr/local/lib/python3.11/dist-packages (from datasets-&gt;fastbook) (18.1.0)\nRequirement already satisfied: dill&lt;0.3.8,&gt;=0.3.0 in /usr/local/lib/python3.11/dist-packages (from datasets-&gt;fastbook) (0.3.7)\nRequirement already satisfied: xxhash in /usr/local/lib/python3.11/dist-packages (from datasets-&gt;fastbook) (3.5.0)\nRequirement already satisfied: multiprocess in /usr/local/lib/python3.11/dist-packages (from datasets-&gt;fastbook) (0.70.15)\nRequirement already satisfied: aiohttp in /usr/local/lib/python3.11/dist-packages (from datasets-&gt;fastbook) (3.11.15)\nRequirement already satisfied: huggingface-hub&lt;1.0.0,&gt;=0.14.0 in /usr/local/lib/python3.11/dist-packages (from datasets-&gt;fastbook) (0.33.4)\nRequirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib-&gt;fastai) (1.3.2)\nRequirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib-&gt;fastai) (0.12.1)\nRequirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib-&gt;fastai) (4.58.5)\nRequirement already satisfied: kiwisolver&gt;=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib-&gt;fastai) (1.4.8)\nRequirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib-&gt;fastai) (3.2.3)\nRequirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib-&gt;fastai) (2.9.0.post0)\nRequirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas-&gt;fastai) (2025.2)\nRequirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas-&gt;fastai) (2025.2)\nCollecting beartype&gt;=0.16.2 (from plum-dispatch-&gt;fastai)\n  Downloading beartype-0.21.0-py3-none-any.whl.metadata (33 kB)\nRequirement already satisfied: rich&gt;=10.0 in /usr/local/lib/python3.11/dist-packages (from plum-dispatch-&gt;fastai) (13.9.4)\nRequirement already satisfied: joblib&gt;=1.2.0 in /usr/local/lib/python3.11/dist-packages (from scikit-learn-&gt;fastai) (1.5.1)\nRequirement already satisfied: threadpoolctl&gt;=3.1.0 in /usr/local/lib/python3.11/dist-packages (from scikit-learn-&gt;fastai) (3.6.0)\nRequirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.11/dist-packages (from transformers-&gt;fastbook) (2024.11.6)\nRequirement already satisfied: tokenizers&lt;0.22,&gt;=0.21 in /usr/local/lib/python3.11/dist-packages (from transformers-&gt;fastbook) (0.21.2)\nRequirement already satisfied: safetensors&gt;=0.4.3 in /usr/local/lib/python3.11/dist-packages (from transformers-&gt;fastbook) (0.5.3)\nRequirement already satisfied: aiohappyeyeballs&gt;=2.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp-&gt;datasets-&gt;fastbook) (2.6.1)\nRequirement already satisfied: aiosignal&gt;=1.1.2 in /usr/local/lib/python3.11/dist-packages (from aiohttp-&gt;datasets-&gt;fastbook) (1.4.0)\nRequirement already satisfied: attrs&gt;=17.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp-&gt;datasets-&gt;fastbook) (25.3.0)\nRequirement already satisfied: frozenlist&gt;=1.1.1 in /usr/local/lib/python3.11/dist-packages (from aiohttp-&gt;datasets-&gt;fastbook) (1.7.0)\nRequirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /usr/local/lib/python3.11/dist-packages (from aiohttp-&gt;datasets-&gt;fastbook) (6.6.3)\nRequirement already satisfied: propcache&gt;=0.2.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp-&gt;datasets-&gt;fastbook) (0.3.2)\nRequirement already satisfied: yarl&lt;2.0,&gt;=1.17.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp-&gt;datasets-&gt;fastbook) (1.20.1)\nRequirement already satisfied: hf-xet&lt;2.0.0,&gt;=1.1.2 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub&lt;1.0.0,&gt;=0.14.0-&gt;datasets-&gt;fastbook) (1.1.5)\nRequirement already satisfied: debugpy&gt;=1.0 in /usr/local/lib/python3.11/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets&lt;8-&gt;fastbook) (1.8.0)\nRequirement already satisfied: jupyter-client&gt;=6.1.12 in /usr/local/lib/python3.11/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets&lt;8-&gt;fastbook) (6.1.12)\nRequirement already satisfied: matplotlib-inline&gt;=0.1 in /usr/local/lib/python3.11/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets&lt;8-&gt;fastbook) (0.1.7)\nRequirement already satisfied: nest-asyncio in /usr/local/lib/python3.11/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets&lt;8-&gt;fastbook) (1.6.0)\nRequirement already satisfied: psutil in /usr/local/lib/python3.11/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets&lt;8-&gt;fastbook) (5.9.5)\nRequirement already satisfied: pyzmq&gt;=17 in /usr/local/lib/python3.11/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets&lt;8-&gt;fastbook) (24.0.1)\nRequirement already satisfied: tornado&gt;=6.1 in /usr/local/lib/python3.11/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets&lt;8-&gt;fastbook) (6.4.2)\nCollecting jedi&gt;=0.16 (from ipython&gt;=4.0.0-&gt;ipywidgets&lt;8-&gt;fastbook)\n  Downloading jedi-0.19.2-py2.py3-none-any.whl.metadata (22 kB)\nRequirement already satisfied: decorator in /usr/local/lib/python3.11/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&lt;8-&gt;fastbook) (4.4.2)\nRequirement already satisfied: pickleshare in /usr/local/lib/python3.11/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.7.5)\nRequirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0 in /usr/local/lib/python3.11/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&lt;8-&gt;fastbook) (3.0.51)\nRequirement already satisfied: pygments in /usr/local/lib/python3.11/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&lt;8-&gt;fastbook) (2.19.2)\nRequirement already satisfied: backcall in /usr/local/lib/python3.11/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.2.0)\nRequirement already satisfied: pexpect&gt;4.3 in /usr/local/lib/python3.11/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&lt;8-&gt;fastbook) (4.9.0)\nRequirement already satisfied: language-data&gt;=1.2 in /usr/local/lib/python3.11/dist-packages (from langcodes&lt;4.0.0,&gt;=3.2.0-&gt;spacy&lt;4-&gt;fastai) (1.3.0)\nRequirement already satisfied: annotated-types&gt;=0.6.0 in /usr/local/lib/python3.11/dist-packages (from pydantic!=1.8,!=1.8.1,&lt;3.0.0,&gt;=1.7.4-&gt;spacy&lt;4-&gt;fastai) (0.7.0)\nRequirement already satisfied: pydantic-core==2.33.2 in /usr/local/lib/python3.11/dist-packages (from pydantic!=1.8,!=1.8.1,&lt;3.0.0,&gt;=1.7.4-&gt;spacy&lt;4-&gt;fastai) (2.33.2)\nRequirement already satisfied: typing-inspection&gt;=0.4.0 in /usr/local/lib/python3.11/dist-packages (from pydantic!=1.8,!=1.8.1,&lt;3.0.0,&gt;=1.7.4-&gt;spacy&lt;4-&gt;fastai) (0.4.1)\nRequirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil&gt;=2.7-&gt;matplotlib-&gt;fastai) (1.17.0)\nRequirement already satisfied: markdown-it-py&gt;=2.2.0 in /usr/local/lib/python3.11/dist-packages (from rich&gt;=10.0-&gt;plum-dispatch-&gt;fastai) (3.0.0)\nRequirement already satisfied: blis&lt;1.4.0,&gt;=1.3.0 in /usr/local/lib/python3.11/dist-packages (from thinc&lt;8.4.0,&gt;=8.3.4-&gt;spacy&lt;4-&gt;fastai) (1.3.0)\nRequirement already satisfied: confection&lt;1.0.0,&gt;=0.0.1 in /usr/local/lib/python3.11/dist-packages (from thinc&lt;8.4.0,&gt;=8.3.4-&gt;spacy&lt;4-&gt;fastai) (0.1.5)\nRequirement already satisfied: shellingham&gt;=1.3.0 in /usr/local/lib/python3.11/dist-packages (from typer&lt;1.0.0,&gt;=0.3.0-&gt;spacy&lt;4-&gt;fastai) (1.5.4)\nRequirement already satisfied: cloudpathlib&lt;1.0.0,&gt;=0.7.0 in /usr/local/lib/python3.11/dist-packages (from weasel&lt;0.5.0,&gt;=0.1.0-&gt;spacy&lt;4-&gt;fastai) (0.21.1)\nRequirement already satisfied: smart-open&lt;8.0.0,&gt;=5.2.1 in /usr/local/lib/python3.11/dist-packages (from weasel&lt;0.5.0,&gt;=0.1.0-&gt;spacy&lt;4-&gt;fastai) (7.3.0.post1)\nRequirement already satisfied: notebook&gt;=4.4.1 in /usr/local/lib/python3.11/dist-packages (from widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (6.5.7)\nRequirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.11/dist-packages (from jinja2-&gt;spacy&lt;4-&gt;fastai) (3.0.2)\nRequirement already satisfied: parso&lt;0.9.0,&gt;=0.8.4 in /usr/local/lib/python3.11/dist-packages (from jedi&gt;=0.16-&gt;ipython&gt;=4.0.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.8.4)\nRequirement already satisfied: jupyter-core&gt;=4.6.0 in /usr/local/lib/python3.11/dist-packages (from jupyter-client&gt;=6.1.12-&gt;ipykernel&gt;=4.5.1-&gt;ipywidgets&lt;8-&gt;fastbook) (5.8.1)\nRequirement already satisfied: marisa-trie&gt;=1.1.0 in /usr/local/lib/python3.11/dist-packages (from language-data&gt;=1.2-&gt;langcodes&lt;4.0.0,&gt;=3.2.0-&gt;spacy&lt;4-&gt;fastai) (1.2.1)\nRequirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.11/dist-packages (from markdown-it-py&gt;=2.2.0-&gt;rich&gt;=10.0-&gt;plum-dispatch-&gt;fastai) (0.1.2)\nRequirement already satisfied: argon2-cffi in /usr/local/lib/python3.11/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (25.1.0)\nRequirement already satisfied: nbformat in /usr/local/lib/python3.11/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (5.10.4)\nRequirement already satisfied: nbconvert&gt;=5 in /usr/local/lib/python3.11/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (7.16.6)\nRequirement already satisfied: Send2Trash&gt;=1.8.0 in /usr/local/lib/python3.11/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (1.8.3)\nRequirement already satisfied: terminado&gt;=0.8.3 in /usr/local/lib/python3.11/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.18.1)\nRequirement already satisfied: prometheus-client in /usr/local/lib/python3.11/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.22.1)\nRequirement already satisfied: nbclassic&gt;=0.4.7 in /usr/local/lib/python3.11/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (1.3.1)\nRequirement already satisfied: ptyprocess&gt;=0.5 in /usr/local/lib/python3.11/dist-packages (from pexpect&gt;4.3-&gt;ipython&gt;=4.0.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.7.0)\nRequirement already satisfied: wcwidth in /usr/local/lib/python3.11/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0-&gt;ipython&gt;=4.0.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.2.13)\nRequirement already satisfied: wrapt in /usr/local/lib/python3.11/dist-packages (from smart-open&lt;8.0.0,&gt;=5.2.1-&gt;weasel&lt;0.5.0,&gt;=0.1.0-&gt;spacy&lt;4-&gt;fastai) (1.17.2)\nRequirement already satisfied: platformdirs&gt;=2.5 in /usr/local/lib/python3.11/dist-packages (from jupyter-core&gt;=4.6.0-&gt;jupyter-client&gt;=6.1.12-&gt;ipykernel&gt;=4.5.1-&gt;ipywidgets&lt;8-&gt;fastbook) (4.3.8)\nRequirement already satisfied: notebook-shim&gt;=0.2.3 in /usr/local/lib/python3.11/dist-packages (from nbclassic&gt;=0.4.7-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.2.4)\nRequirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.11/dist-packages (from nbconvert&gt;=5-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (4.13.4)\nRequirement already satisfied: bleach!=5.0.0 in /usr/local/lib/python3.11/dist-packages (from bleach[css]!=5.0.0-&gt;nbconvert&gt;=5-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (6.2.0)\nRequirement already satisfied: defusedxml in /usr/local/lib/python3.11/dist-packages (from nbconvert&gt;=5-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.7.1)\nRequirement already satisfied: jupyterlab-pygments in /usr/local/lib/python3.11/dist-packages (from nbconvert&gt;=5-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.3.0)\nRequirement already satisfied: mistune&lt;4,&gt;=2.0.3 in /usr/local/lib/python3.11/dist-packages (from nbconvert&gt;=5-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (3.1.3)\nRequirement already satisfied: nbclient&gt;=0.5.0 in /usr/local/lib/python3.11/dist-packages (from nbconvert&gt;=5-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.10.2)\nRequirement already satisfied: pandocfilters&gt;=1.4.1 in /usr/local/lib/python3.11/dist-packages (from nbconvert&gt;=5-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (1.5.1)\nRequirement already satisfied: fastjsonschema&gt;=2.15 in /usr/local/lib/python3.11/dist-packages (from nbformat-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (2.21.1)\nRequirement already satisfied: jsonschema&gt;=2.6 in /usr/local/lib/python3.11/dist-packages (from nbformat-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (4.24.0)\nRequirement already satisfied: argon2-cffi-bindings in /usr/local/lib/python3.11/dist-packages (from argon2-cffi-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (21.2.0)\nRequirement already satisfied: webencodings in /usr/local/lib/python3.11/dist-packages (from bleach!=5.0.0-&gt;bleach[css]!=5.0.0-&gt;nbconvert&gt;=5-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.5.1)\nRequirement already satisfied: tinycss2&lt;1.5,&gt;=1.1.0 in /usr/local/lib/python3.11/dist-packages (from bleach[css]!=5.0.0-&gt;nbconvert&gt;=5-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (1.4.0)\nRequirement already satisfied: jsonschema-specifications&gt;=2023.03.6 in /usr/local/lib/python3.11/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (2025.4.1)\nRequirement already satisfied: referencing&gt;=0.28.4 in /usr/local/lib/python3.11/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.36.2)\nRequirement already satisfied: rpds-py&gt;=0.7.1 in /usr/local/lib/python3.11/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (0.26.0)\nRequirement already satisfied: jupyter-server&lt;3,&gt;=1.8 in /usr/local/lib/python3.11/dist-packages (from notebook-shim&gt;=0.2.3-&gt;nbclassic&gt;=0.4.7-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (1.16.0)\nRequirement already satisfied: cffi&gt;=1.0.1 in /usr/local/lib/python3.11/dist-packages (from argon2-cffi-bindings-&gt;argon2-cffi-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (1.17.1)\nRequirement already satisfied: soupsieve&gt;1.2 in /usr/local/lib/python3.11/dist-packages (from beautifulsoup4-&gt;nbconvert&gt;=5-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (2.7)\nRequirement already satisfied: pycparser in /usr/local/lib/python3.11/dist-packages (from cffi&gt;=1.0.1-&gt;argon2-cffi-bindings-&gt;argon2-cffi-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (2.22)\nRequirement already satisfied: anyio&gt;=3.1.0 in /usr/local/lib/python3.11/dist-packages (from jupyter-server&lt;3,&gt;=1.8-&gt;notebook-shim&gt;=0.2.3-&gt;nbclassic&gt;=0.4.7-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (4.9.0)\nRequirement already satisfied: websocket-client in /usr/local/lib/python3.11/dist-packages (from jupyter-server&lt;3,&gt;=1.8-&gt;notebook-shim&gt;=0.2.3-&gt;nbclassic&gt;=0.4.7-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (1.8.0)\nRequirement already satisfied: sniffio&gt;=1.1 in /usr/local/lib/python3.11/dist-packages (from anyio&gt;=3.1.0-&gt;jupyter-server&lt;3,&gt;=1.8-&gt;notebook-shim&gt;=0.2.3-&gt;nbclassic&gt;=0.4.7-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&lt;8-&gt;fastbook) (1.3.1)\nDownloading fastai-2.8.2-py3-none-any.whl (235 kB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m235.3/235.3 kB\u001b[0m \u001b[31m12.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading fastcore-1.8.5-py3-none-any.whl (79 kB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m79.3/79.3 kB\u001b[0m \u001b[31m5.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading fastbook-0.0.29-py3-none-any.whl (719 kB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m719.8/719.8 kB\u001b[0m \u001b[31m24.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading ddgs-9.3.1-py3-none-any.whl (33 kB)\nDownloading fasttransform-0.0.2-py3-none-any.whl (14 kB)\nDownloading primp-0.15.0-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.3 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m3.3/3.3 MB\u001b[0m \u001b[31m36.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading nvidia_cublas_cu12-12.4.5.8-py3-none-manylinux2014_x86_64.whl (363.4 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m363.4/363.4 MB\u001b[0m \u001b[31m4.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading nvidia_cuda_cupti_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (13.8 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m13.8/13.8 MB\u001b[0m \u001b[31m52.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading nvidia_cuda_nvrtc_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (24.6 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m24.6/24.6 MB\u001b[0m \u001b[31m27.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading nvidia_cuda_runtime_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (883 kB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m883.7/883.7 kB\u001b[0m \u001b[31m20.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl (664.8 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m664.8/664.8 MB\u001b[0m \u001b[31m2.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading nvidia_cufft_cu12-11.2.1.3-py3-none-manylinux2014_x86_64.whl (211.5 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m211.5/211.5 MB\u001b[0m \u001b[31m6.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading nvidia_curand_cu12-10.3.5.147-py3-none-manylinux2014_x86_64.whl (56.3 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m56.3/56.3 MB\u001b[0m \u001b[31m12.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading nvidia_cusolver_cu12-11.6.1.9-py3-none-manylinux2014_x86_64.whl (127.9 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m127.9/127.9 MB\u001b[0m \u001b[31m7.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading nvidia_cusparse_cu12-12.3.1.170-py3-none-manylinux2014_x86_64.whl (207.5 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m207.5/207.5 MB\u001b[0m \u001b[31m6.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading nvidia_nvjitlink_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (21.1 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m21.1/21.1 MB\u001b[0m \u001b[31m84.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading plum_dispatch-2.5.7-py3-none-any.whl (42 kB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m42.6/42.6 kB\u001b[0m \u001b[31m2.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading beartype-0.21.0-py3-none-any.whl (1.2 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.2/1.2 MB\u001b[0m \u001b[31m54.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hDownloading jedi-0.19.2-py2.py3-none-any.whl (1.6 MB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.6/1.6 MB\u001b[0m \u001b[31m63.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hInstalling collected packages: primp, nvidia-nvjitlink-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, jedi, fastcore, beartype, nvidia-cusparse-cu12, nvidia-cudnn-cu12, ddgs, plum-dispatch, nvidia-cusolver-cu12, fasttransform, fastai, fastbook\n  Attempting uninstall: nvidia-nvjitlink-cu12\n    Found existing installation: nvidia-nvjitlink-cu12 12.5.82\n    Uninstalling nvidia-nvjitlink-cu12-12.5.82:\n      Successfully uninstalled nvidia-nvjitlink-cu12-12.5.82\n  Attempting uninstall: nvidia-curand-cu12\n    Found existing installation: nvidia-curand-cu12 10.3.6.82\n    Uninstalling nvidia-curand-cu12-10.3.6.82:\n      Successfully uninstalled nvidia-curand-cu12-10.3.6.82\n  Attempting uninstall: nvidia-cufft-cu12\n    Found existing installation: nvidia-cufft-cu12 11.2.3.61\n    Uninstalling nvidia-cufft-cu12-11.2.3.61:\n      Successfully uninstalled nvidia-cufft-cu12-11.2.3.61\n  Attempting uninstall: nvidia-cuda-runtime-cu12\n    Found existing installation: nvidia-cuda-runtime-cu12 12.5.82\n    Uninstalling nvidia-cuda-runtime-cu12-12.5.82:\n      Successfully uninstalled nvidia-cuda-runtime-cu12-12.5.82\n  Attempting uninstall: nvidia-cuda-nvrtc-cu12\n    Found existing installation: nvidia-cuda-nvrtc-cu12 12.5.82\n    Uninstalling nvidia-cuda-nvrtc-cu12-12.5.82:\n      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.5.82\n  Attempting uninstall: nvidia-cuda-cupti-cu12\n    Found existing installation: nvidia-cuda-cupti-cu12 12.5.82\n    Uninstalling nvidia-cuda-cupti-cu12-12.5.82:\n      Successfully uninstalled nvidia-cuda-cupti-cu12-12.5.82\n  Attempting uninstall: nvidia-cublas-cu12\n    Found existing installation: nvidia-cublas-cu12 12.5.3.2\n    Uninstalling nvidia-cublas-cu12-12.5.3.2:\n      Successfully uninstalled nvidia-cublas-cu12-12.5.3.2\n  Attempting uninstall: fastcore\n    Found existing installation: fastcore 1.7.29\n    Uninstalling fastcore-1.7.29:\n      Successfully uninstalled fastcore-1.7.29\n  Attempting uninstall: nvidia-cusparse-cu12\n    Found existing installation: nvidia-cusparse-cu12 12.5.1.3\n    Uninstalling nvidia-cusparse-cu12-12.5.1.3:\n      Successfully uninstalled nvidia-cusparse-cu12-12.5.1.3\n  Attempting uninstall: nvidia-cudnn-cu12\n    Found existing installation: nvidia-cudnn-cu12 9.3.0.75\n    Uninstalling nvidia-cudnn-cu12-9.3.0.75:\n      Successfully uninstalled nvidia-cudnn-cu12-9.3.0.75\n  Attempting uninstall: nvidia-cusolver-cu12\n    Found existing installation: nvidia-cusolver-cu12 11.6.3.83\n    Uninstalling nvidia-cusolver-cu12-11.6.3.83:\n      Successfully uninstalled nvidia-cusolver-cu12-11.6.3.83\n  Attempting uninstall: fastai\n    Found existing installation: fastai 2.7.19\n    Uninstalling fastai-2.7.19:\n      Successfully uninstalled fastai-2.7.19\nSuccessfully installed beartype-0.21.0 ddgs-9.3.1 fastai-2.8.2 fastbook-0.0.29 fastcore-1.8.5 fasttransform-0.0.2 jedi-0.19.2 nvidia-cublas-cu12-12.4.5.8 nvidia-cuda-cupti-cu12-12.4.127 nvidia-cuda-nvrtc-cu12-12.4.127 nvidia-cuda-runtime-cu12-12.4.127 nvidia-cudnn-cu12-9.1.0.70 nvidia-cufft-cu12-11.2.1.3 nvidia-curand-cu12-10.3.5.147 nvidia-cusolver-cu12-11.6.1.9 nvidia-cusparse-cu12-12.3.1.170 nvidia-nvjitlink-cu12-12.4.127 plum-dispatch-2.5.7 primp-0.15.0\nMounted at /content/gdrive\nfrom fastbook import *\nfrom fastai.vision.widgets import *\nfrom ddgs import DDGS\nimport time, random\nfrom pathlib import Path\n\n# 1. Collect data\nanimals = [\"cat\", \"dog\"]\npath = Path('animals')  # Path to store images\n\nif not path.exists():\n    path.mkdir()\n\nfor animal in animals:\n    dest = (path/animal)\n    dest.mkdir(exist_ok=True)\n    with DDGS() as ddg:\n        results = [r for r in ddg.images(f'{animal}', max_results=100)]  # Search for cat or dog images\n        # Extract content URLs from the result dictionaries\n        urls = [r.get('image') or r.get('contentUrl') for r in results if r.get('image') or r.get('contentUrl')]\n        # Random delay to avoid spamming the server\n        time.sleep(random.uniform(1, 3))\n        # Download the images\n        download_images(dest, urls=urls)\n# List results\nfns = get_image_files(path)\nprint(len(fns))\n184\nNow that the process of collecting data is over, we need to check if any are corrupted. By corrupted, we usually refer to files that return an error when trying to open them. An image or file is corrupted when: * Downloaded incompletly * Subject to network tranmission errors * Storage or memory issues * File-system or server-side problems and if that’s the case clean them.\nTo check for integrity, we use the verify_images function. This will return a collection object that has a map method which calls the passed function onto each element of the collection. In this case it’s the unlink function that will handle the cleaning of corrupted files.\nfailed = verify_images(fns)\nprint(failed)\nfailed.map(Path.unlink);\n/usr/local/lib/python3.11/dist-packages/PIL/Image.py:3570: UserWarning: image file could not be identified because AVIF support not installed\n  warnings.warn(message)\n/usr/local/lib/python3.11/dist-packages/PIL/Image.py:3570: UserWarning: image file could not be identified because AVIF support not installed\n  warnings.warn(message)\n\n\n[Path('animals/cat/d97e5771-40d9-4a1e-b1a3-849a32bca85a.jpg'), Path('animals/dog/743b109f-0222-4cc2-b1aa-fa95f3811185.jpg'), Path('animals/dog/fddc2b23-6712-4803-838d-81729f8efef5.jpg'), Path('animals/dog/3c41c6ee-858c-4b6d-9660-fbacab718d1c.jpg'), Path('animals/dog/c517196a-abde-49a6-b28c-35c4980dd228.jpg'), Path('animals/dog/f5b15c94-0dc4-4c75-b7f7-7cb7c3cc8854.jpg'), Path('animals/dog/97123c37-6e78-4ee9-9e8c-f1b85314e046.jpg'), Path('animals/dog/684ef9f1-9b6e-4154-bf3f-a077657ed265.jpg'), Path('animals/dog/d0fb283f-eee8-40f2-a1da-6195368eb85e.jpg')]\nNow that we have our dataset, it’s time to split it into train, validation and test sets. * Training Set: Used to teach the model.\n\nValidation Set: Used during development to tune model settings (hyperparameters) and check generalization.\nTest Set: Used only at the end to fairly evaluate final model performance on unseen data.\n\nWithout separate sets, the model (or developers) might overfit—performing well on known data but poorly on new data. The test set ensures honest, unbiased evaluation and helps prevent self-deception or vendor manipulation.\nKeep in mind that data is usually biased, and if that’s not taken into consideration, your model will end up equally biased.\nTo achieve that we use a DataLoader on each set and a thin super class DataLoaders to combine them all.\n# 3. Define the DataBlock\ncatVsDog = DataBlock(\n    blocks=(ImageBlock, CategoryBlock),                 # Image = input, Category = output\n    get_items=get_image_files,                          # Collect all image file paths\n    splitter=RandomSplitter(valid_pct=0.2, seed=42),    # 80/20 train/val split\n    get_y=parent_label,                                 # Label = name of parent folder (e.g. 'cat' or 'dog')\n    item_tfms=RandomResizedCrop(224, min_scale=0.5),    # Resize and crop images\n    batch_tfms=aug_transforms(mult=2)                   # Augmentations like flip, rotate, etc.\n)\n\n# 4. Create DataLoaders\ntry:\n    dls = catVsDog.dataloaders(path)\n    print(\"DataLoaders created successfully!\")\n\n    # Show a sample batch to verify everything works\n    dls.show_batch(max_n=8)\n\n    # 5. Create learner with resnet18 and track error rate\n    learn = vision_learner(dls, resnet18, metrics=error_rate)\n\n    # 6. Train the model for 4 epochs with fine-tuning\n    learn.fine_tune(4)\n\nexcept Exception as e:\n    print(f\"Error creating DataLoaders: {e}\")\n    print(\"This might be due to remaining corrupted images. Let's do a more thorough cleanup...\")\nDataLoaders created successfully!\n\n\nDownloading: \"https://download.pytorch.org/models/resnet18-f37072fd.pth\" to /root/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth\n100%|██████████| 44.7M/44.7M [00:00&lt;00:00, 107MB/s]\n\n\n\n\n\nepoch\n\n\ntrain_loss\n\n\nvalid_loss\n\n\nerror_rate\n\n\ntime\n\n\n\n\n\n\n0\n\n\n1.476215\n\n\n0.458743\n\n\n0.171429\n\n\n00:40\n\n\n\n\n\n\n\n\n\nepoch\n\n\ntrain_loss\n\n\nvalid_loss\n\n\nerror_rate\n\n\ntime\n\n\n\n\n\n\n0\n\n\n0.419707\n\n\n0.177242\n\n\n0.057143\n\n\n00:58\n\n\n\n\n1\n\n\n0.326388\n\n\n0.171967\n\n\n0.028571\n\n\n00:54\n\n\n\n\n2\n\n\n0.235696\n\n\n0.221325\n\n\n0.057143\n\n\n00:58\n\n\n\n\n3\n\n\n0.188272\n\n\n0.234519\n\n\n0.057143\n\n\n00:56\n\n\n\n\n\n\n\npng\n\n\nThe train and validation losses seem alright. But we still need to see where exactly our errors are occuring.\ninterp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix()\n\n\n\n\n\npng\n\n\ninterp.plot_top_losses(5, nrows=1)\n\n\n\n\npng\n\n\nThere is clearly an image where I have both animals but labelled as cat so I choose &lt;Delete&gt;. As for the small doggo being mistaken for a cat, work hazard I suppose.\ncleaner = ImageClassifierCleaner(learn)\ncleaner\n\n\nVBox(children=(Dropdown(options=('cat', 'dog'), value='cat'), Dropdown(options=('Train', 'Valid'), value='Trai…\nfor idx in cleaner.delete(): cleaner.fns[idx].unlink()\nfor idx,cat in cleaner.change(): shutil.move(str(cleaner.fns[idx]), path/cat)\nLet’s re-train for another epoch or two now that the data is cleaned.\n# We keep the same transforms etc.\ndls = catVsDog.dataloaders(path)\nprint(\"DataLoaders created successfully!\")\n\n# Re-create learner with resnet18 and track error rate\nlearn = vision_learner(dls, resnet18, metrics=error_rate)\n\n# Train the model for 4 epochs with fine-tuning\nlearn.fine_tune(4)\nDataLoaders created successfully!\n\n\n\n\n\nepoch\n\n\ntrain_loss\n\n\nvalid_loss\n\n\nerror_rate\n\n\ntime\n\n\n\n\n\n\n0\n\n\n1.132787\n\n\n0.483606\n\n\n0.212121\n\n\n00:42\n\n\n\n\n\n\n\n\n\nepoch\n\n\ntrain_loss\n\n\nvalid_loss\n\n\nerror_rate\n\n\ntime\n\n\n\n\n\n\n0\n\n\n0.372304\n\n\n0.206328\n\n\n0.030303\n\n\n00:58\n\n\n\n\n1\n\n\n0.317983\n\n\n0.132354\n\n\n0.030303\n\n\n01:00\n\n\n\n\n2\n\n\n0.241134\n\n\n0.078701\n\n\n0.030303\n\n\n00:58\n\n\n\n\n3\n\n\n0.188229\n\n\n0.051700\n\n\n0.030303\n\n\n01:04\n\n\n\n\n\n\n2 Turning the Model into a Web Application\nOnce the model fine tuned, it’s time to save it so it can be used in production.\nlearn.export(\"CatVsDog.pkl\")\n# Make sure the model is correctly saved\npath = Path()\npath.ls(file_exts='.pkl')\n(#1) [Path('CatVsDog.pkl')]\nTime to use this inference learned in a web application. For that I opted for gradio for fast showcasing. In the book, however they used voila along with jupyter notebook for deployment.\n!pip install gradio\nimport gradio as gr\nfrom fastai.vision.all import *\n\n# Load your model\nlearn = load_learner('export.pkl')  # Your Fastai model\n\n# Define prediction function\ndef predict(img):\n    _, _, probs = learn.predict(img)\n    return {learn.dls.vocab[i]: float(probs[i]) for i in range(len(probs))}\n\n# Build interface\ninterface = gr.Interface(fn=predict, inputs=gr.Image(type=\"pil\"), outputs=gr.Label())\ninterface.launch()\n\n\n3 Notes on Development & Deployment\nWhile working on this first post, I encountered and resolved several challenges worth documenting.\nInitially, all development—including model training and testing—was done in a Google Colab notebook. I wanted to preserve the cell outputs from that session to accurately reflect the training process in the final blog post. This meant converting the Colab notebook into a Quarto .qmd file without re-executing the code during rendering, so outputs would remain intact.\nTo prevent code re-execution, I added the following to both the YAML header of the .qmd file and the global Quarto configuration:\ntitle: Title\njupyter: python3\nexecute:\n  freeze: true\nHowever, using quarto convert my-notebook.ipynb didn’t preserve the output cells as expected. A reliable workaround was to first convert the notebook to Markdown:\njupyter nbconvert my-notebook.ipynb --to markdown --output converted-notebook.qmd\nThen, I renamed the file to .qmd and manually added the necessary YAML header.\nAnother issue arose when I attempted to run the exported model on my local Windows machine. Since the model was trained in a Unix environment, it used PosixPath internally (via pathlib), which led to this error on Windows:\nNotImplementedError: cannot instantiate 'PosixPath' on your system\nTo resolve this, I patched PosixPath to WindowsPath during model loading:\n\nimport platform\nfrom pathlib import Path\nif platform.system() == 'Windows':\n    import pathlib\n    pathlib.PosixPath = pathlib.WindowsPath\n\nLastly, for consistent predictions, ensure your local environment mirrors the dependency versions used during model training—particularly for fastai, torch, and torchvision."
  }
]